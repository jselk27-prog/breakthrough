<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BreakFree</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700;800&family=Lora:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg: #0f1117;
      --surface: #161b27;
      --surface2: #1e2435;
      --border: #2a3048;
      --accent: #6b9fff;
      --accent2: #a0c4ff;
      --text: #e8edf8;
      --muted: #7a8aaa;
      --success: #6be8b0;
      --gold: #ffd166;
    }

    html, body {
      min-height: 100%;
      background: var(--bg);
      color: var(--text);
      font-family: 'Nunito', sans-serif;
      font-size: 16px;
      line-height: 1.6;
      overflow-x: hidden;
    }

    body::after {
      content: '';
      position: fixed;
      top: -200px; left: 50%;
      transform: translateX(-50%);
      width: 700px; height: 700px;
      background: radial-gradient(circle, rgba(107,159,255,0.08) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }

    #app {
      position: relative;
      z-index: 1;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0 24px 100px;
    }

    /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
    header {
      width: 100%; max-width: 640px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 28px 0 0;
    }

    .logo { font-weight: 800; font-size: 1.3rem; letter-spacing: -0.02em; }
    .logo span { color: var(--accent); }
    .header-right { display: flex; align-items: center; gap: 10px; }

    .points-badge {
      font-size: 0.76rem; font-weight: 700;
      color: var(--gold);
      background: rgba(255,209,102,0.08);
      border: 1px solid rgba(255,209,102,0.2);
      padding: 4px 12px; border-radius: 999px;
      display: none; align-items: center; gap: 5px;
    }

    .calls-badge {
      font-size: 0.73rem; color: var(--muted);
      background: var(--surface);
      border: 1px solid var(--border);
      padding: 4px 12px; border-radius: 999px;
      display: flex; align-items: center; gap: 6px;
    }

    .calls-badge .dot {
      width: 6px; height: 6px; border-radius: 50%;
      background: var(--success);
      animation: pulse 2s infinite;
    }

    @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.35} }

    /* ‚îÄ‚îÄ LANDING ‚îÄ‚îÄ */
    #landingScreen {
      width: 100%; max-width: 640px;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      text-align: center;
      padding: 100px 0 60px;
      animation: fadeUp 0.8s ease both;
    }

    .landing-eyebrow {
      font-size: 0.68rem; font-weight: 600;
      letter-spacing: 0.2em; text-transform: uppercase;
      color: var(--accent); margin-bottom: 20px;
    }

    .landing-title {
      font-weight: 800;
      font-size: clamp(2.6rem, 7vw, 4.2rem);
      line-height: 1.05; letter-spacing: -0.04em;
      margin-bottom: 22px;
    }

    .landing-title em { font-style: normal; color: var(--accent); }

    .landing-sub {
      color: var(--muted); font-size: 1.05rem;
      max-width: 420px; margin: 0 auto 48px;
      line-height: 1.7;
    }

    .btn-start {
      padding: 18px 48px;
      background: var(--accent);
      color: white; border: none;
      border-radius: 999px;
      font-family: 'Nunito', sans-serif;
      font-weight: 800; font-size: 1rem;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      letter-spacing: 0.01em;
    }

    .btn-start:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 36px rgba(107,159,255,0.35);
    }

    .btn-demo {
      margin-top: 16px;
      padding: 12px 32px;
      background: none;
      border: 1.5px solid var(--border);
      color: var(--muted);
      border-radius: 999px;
      font-family: 'Nunito', sans-serif;
      font-weight: 600; font-size: 0.85rem;
      cursor: pointer;
      transition: border-color 0.2s, color 0.2s;
      display: block;
      margin-left: auto; margin-right: auto;
    }
    .btn-demo:hover { border-color: var(--accent); color: var(--text); }

    /* ‚îÄ‚îÄ INTERVIEW ‚îÄ‚îÄ */
    #interviewScreen {
      width: 100%; max-width: 640px;
      display: none;
      padding-top: 60px;
    }

    .interview-progress {
      display: flex; align-items: center; gap: 14px;
      margin-bottom: 52px;
    }

    .progress-track {
      flex: 1; height: 3px;
      background: var(--border); border-radius: 999px;
    }

    .progress-track-fill {
      height: 100%; background: var(--accent);
      border-radius: 999px;
      transition: width 0.5s ease;
    }

    .progress-label {
      font-size: 0.75rem; color: var(--muted);
      white-space: nowrap; font-weight: 600;
    }

    .question-wrap {
      animation: fadeUp 0.5s ease both;
    }

    .question-label {
      font-size: 0.68rem; font-weight: 700;
      letter-spacing: 0.16em; text-transform: uppercase;
      color: var(--accent); margin-bottom: 12px;
    }

    .question-text {
      font-family: 'Lora', serif;
      font-size: clamp(1.4rem, 4vw, 1.85rem);
      font-weight: 500; line-height: 1.3;
      letter-spacing: -0.01em;
      margin-bottom: 36px;
      color: var(--text);
    }

    /* Answer options */
    .options-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 28px;
    }

    .options-grid.single-col { grid-template-columns: 1fr; }

    .option-btn {
      padding: 16px 20px;
      background: var(--surface);
      border: 1.5px solid var(--border);
      border-radius: 14px;
      color: var(--text);
      font-family: 'Nunito', sans-serif;
      font-weight: 600; font-size: 0.92rem;
      cursor: pointer; text-align: left;
      transition: border-color 0.18s, background 0.18s, transform 0.15s;
      line-height: 1.4;
    }

    .option-btn:hover {
      border-color: var(--accent);
      background: rgba(107,159,255,0.07);
      transform: translateY(-1px);
    }

    .option-btn.selected {
      border-color: var(--accent);
      background: rgba(107,159,255,0.12);
    }

    /* Seriousness options */
    .serious-btn {
      padding: 20px;
      display: flex; flex-direction: column; gap: 6px;
    }

    .serious-btn .s-emoji { font-size: 1.5rem; }
    .serious-btn .s-title { font-weight: 700; font-size: 0.95rem; }
    .serious-btn .s-desc { font-size: 0.78rem; color: var(--muted); font-weight: 400; }

    /* Text input style */
    .text-answer-wrap {
      margin-bottom: 28px;
    }

    .text-answer {
      width: 100%;
      background: transparent;
      border: none;
      border-bottom: 2px solid var(--border);
      color: var(--text);
      font-family: 'Lora', serif;
      font-size: 1.2rem;
      padding: 12px 4px;
      outline: none;
      transition: border-color 0.2s;
      border-radius: 0;
    }

    .text-answer::placeholder { color: var(--muted); }
    .text-answer:focus { border-bottom-color: var(--accent); }

    .textarea-answer {
      width: 100%;
      background: transparent;
      border: none;
      border-bottom: 2px solid var(--border);
      color: var(--text);
      font-family: 'Lora', serif;
      font-size: 1.1rem;
      padding: 12px 4px;
      outline: none;
      resize: none;
      min-height: 80px;
      transition: border-color 0.2s;
      border-radius: 0;
    }

    .textarea-answer::placeholder { color: var(--muted); }
    .textarea-answer:focus { border-bottom-color: var(--accent); }

    .btn-next {
      padding: 14px 36px;
      background: var(--accent);
      color: white; border: none;
      border-radius: 999px;
      font-family: 'Nunito', sans-serif;
      font-weight: 800; font-size: 0.92rem;
      cursor: pointer;
      transition: transform 0.15s, box-shadow 0.15s, opacity 0.15s;
    }

    .btn-next:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(107,159,255,0.3);
    }

    .btn-next:disabled { opacity: 0.35; cursor: not-allowed; }

    .btn-back {
      background: none; border: none;
      color: var(--muted); font-family: 'Nunito', sans-serif;
      font-size: 0.85rem; cursor: pointer;
      margin-right: 16px;
      transition: color 0.2s;
    }

    .btn-back:hover { color: var(--text); }

    /* ‚îÄ‚îÄ LOADING ‚îÄ‚îÄ */
    #loadingScreen {
      width: 100%; max-width: 640px;
      text-align: center;
      padding: 100px 0;
      display: none;
    }

    .loader {
      width: 44px; height: 44px;
      border: 3px solid var(--border);
      border-top-color: var(--accent);
      border-radius: 50%;
      margin: 0 auto 32px;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin { to { transform: rotate(360deg); } }

    .loading-title {
      font-weight: 700; font-size: 1.3rem;
      margin-bottom: 10px;
    }

    .loading-sub { color: var(--muted); font-size: 0.9rem; }

    /* ‚îÄ‚îÄ PLAN SCREEN ‚îÄ‚îÄ */
    #planScreen {
      width: 100%; max-width: 640px;
      display: none;
    }

    /* Diagnosis section ‚Äî no card, just typography */
    .dx-section {
      padding: 52px 0 48px;
      border-bottom: 1px solid var(--border);
      margin-bottom: 48px;
      animation: fadeUp 0.6s ease both;
    }

    .dx-eyebrow {
      font-size: 0.68rem; font-weight: 700;
      letter-spacing: 0.18em; text-transform: uppercase;
      color: var(--accent); margin-bottom: 14px;
    }

    .dx-title {
      font-family: 'Lora', serif;
      font-size: clamp(1.8rem, 5vw, 2.6rem);
      font-weight: 500; line-height: 1.2;
      letter-spacing: -0.02em;
      margin-bottom: 18px;
    }

    .dx-text {
      color: var(--muted);
      font-size: 1rem; line-height: 1.8;
      max-width: 540px;
    }

    /* Points strip */
    .points-strip {
      display: flex; align-items: baseline; gap: 10px;
      margin-bottom: 48px;
      animation: fadeUp 0.6s 0.1s ease both;
    }

    .pts-number {
      font-family: 'Nunito', sans-serif;
      font-weight: 800; font-size: 3rem;
      color: var(--gold); line-height: 1;
      transition: all 0.3s;
    }

    .pts-label-big {
      font-size: 0.85rem; color: var(--muted);
      line-height: 1.4;
    }

    .pts-label-big strong { display: block; color: var(--text); font-size: 0.95rem; }

    /* Day view ‚Äî journal style */
    .day-section {
      animation: fadeUp 0.5s ease both;
    }

    .day-nav-top {
      display: flex; align-items: center;
      justify-content: space-between;
      margin-bottom: 32px;
    }

    .day-nav-info {
      display: flex; flex-direction: column; gap: 3px;
    }

    .day-week-label {
      font-size: 0.68rem; font-weight: 700;
      letter-spacing: 0.16em; text-transform: uppercase;
      color: var(--accent);
    }

    .day-number-label {
      font-weight: 800; font-size: 1.6rem;
      letter-spacing: -0.03em; line-height: 1;
    }

    .day-nav-buttons { display: flex; gap: 8px; }

    .nav-arrow {
      width: 38px; height: 38px;
      border-radius: 50%;
      border: 1.5px solid var(--border);
      background: none; color: var(--text);
      font-size: 1rem; cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      transition: border-color 0.2s, background 0.2s;
    }

    .nav-arrow:hover:not(:disabled) {
      border-color: var(--accent);
      background: rgba(107,159,255,0.08);
    }

    .nav-arrow:disabled { opacity: 0.25; cursor: not-allowed; }

    /* Progress bar thin */
    .thin-progress {
      height: 2px; background: var(--border);
      border-radius: 999px; margin-bottom: 40px;
    }

    .thin-progress-fill {
      height: 100%; background: var(--accent);
      border-radius: 999px; transition: width 0.5s ease;
    }

    /* Goals ‚Äî journal entries */
    .goals-area {
      display: flex; flex-direction: column; gap: 0;
    }

    .goal-row {
      display: flex; align-items: flex-start; gap: 20px;
      padding: 20px 0;
      border-bottom: 1px solid rgba(42,48,72,0.6);
      cursor: pointer;
      transition: opacity 0.2s;
    }

    .goal-row:last-child { border-bottom: none; }
    .goal-row:hover { opacity: 0.85; }

    .goal-check-circle {
      width: 24px; height: 24px; flex-shrink: 0;
      border: 2px solid var(--border);
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      margin-top: 2px;
      transition: all 0.25s;
      font-size: 0.75rem;
    }

    .goal-row.done .goal-check-circle {
      background: var(--accent);
      border-color: var(--accent);
    }

    .goal-body { flex: 1; }

    .goal-body-text {
      font-size: 1rem; line-height: 1.6;
      color: var(--text);
      transition: color 0.2s;
    }

    .goal-row.done .goal-body-text {
      color: var(--muted);
      text-decoration: line-through;
      text-decoration-color: rgba(122,138,170,0.4);
    }

    .goal-pts-tag {
      font-size: 0.72rem; font-weight: 700;
      color: var(--gold);
      opacity: 0;
      transition: opacity 0.3s;
      margin-top: 4px;
    }

    .goal-row.done .goal-pts-tag { opacity: 1; }

    /* Today's pts inline */
    .today-pts-line {
      display: flex; align-items: center;
      justify-content: space-between;
      margin-top: 32px;
      padding-top: 24px;
      border-top: 1px solid var(--border);
    }

    .today-pts-line span {
      font-size: 0.82rem; color: var(--muted);
    }

    .today-pts-val {
      font-weight: 800; font-size: 1rem;
      color: var(--gold);
    }

    /* Journal */
    .journal-section {
      margin-top: 36px;
      padding-top: 28px;
      border-top: 1px solid var(--border);
    }

    .journal-label {
      font-size: 0.68rem; font-weight: 700;
      letter-spacing: 0.16em; text-transform: uppercase;
      color: var(--muted); margin-bottom: 14px;
    }

    .journal-field {
      width: 100%;
      background: transparent;
      border: none;
      border-bottom: 2px solid var(--border);
      color: var(--text);
      font-family: 'Lora', serif;
      font-size: 0.95rem; line-height: 1.7;
      padding: 8px 4px 12px;
      outline: none; resize: none;
      min-height: 90px;
      transition: border-color 0.2s;
      border-radius: 0;
    }

    .journal-field:focus { border-bottom-color: var(--accent); }
    .journal-field::placeholder { color: var(--muted); font-style: italic; }

    .journal-saved {
      font-size: 0.74rem; color: var(--muted);
      margin-top: 8px; height: 16px;
      transition: opacity 0.4s;
    }

    /* Lock-in section */
    .lockin-section {
      padding: 52px 0 40px;
      border-top: 1px solid var(--border);
      margin-top: 52px;
      animation: fadeUp 0.5s ease both;
    }

    .lockin-eyebrow {
      font-size: 0.68rem; font-weight: 700;
      letter-spacing: 0.18em; text-transform: uppercase;
      color: var(--accent); margin-bottom: 16px;
    }

    .lockin-title {
      font-family: 'Lora', serif;
      font-size: 1.8rem; font-weight: 500;
      margin-bottom: 14px; line-height: 1.25;
    }

    .commitment-quote {
      font-family: 'Lora', serif;
      font-style: italic;
      color: var(--muted);
      font-size: 1rem; line-height: 1.7;
      margin-bottom: 32px;
      padding-left: 20px;
      border-left: 2px solid var(--border);
    }

    .lockin-input-row {
      display: flex; gap: 12px; max-width: 400px;
    }

    .lockin-field {
      flex: 1;
      background: transparent;
      border: none;
      border-bottom: 2px solid var(--border);
      color: var(--text);
      font-family: 'Nunito', sans-serif;
      font-size: 1rem; font-weight: 600;
      padding: 10px 4px;
      outline: none;
      transition: border-color 0.2s;
      border-radius: 0;
    }

    .lockin-field:focus { border-bottom-color: var(--accent); }
    .lockin-field::placeholder { color: var(--muted); }

    .btn-lockin {
      padding: 12px 24px;
      background: var(--accent); color: white;
      border: none; border-radius: 999px;
      font-family: 'Nunito', sans-serif;
      font-weight: 800; font-size: 0.88rem;
      cursor: pointer;
      transition: transform 0.15s, box-shadow 0.15s;
    }

    .btn-lockin:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(107,159,255,0.3);
    }

    .locked-msg {
      display: none;
      color: var(--success);
      font-weight: 700; font-size: 0.95rem;
      margin-top: 18px;
      animation: fadeUp 0.4s ease both;
    }

    /* Support section */
    .support-section {
      padding: 40px 0;
      border-top: 1px solid var(--border);
      margin-top: 8px;
      display: none;
    }

    .support-label {
      font-size: 0.68rem; font-weight: 700;
      letter-spacing: 0.16em; text-transform: uppercase;
      color: var(--muted); margin-bottom: 20px;
    }

    .chat-messages {
      display: flex; flex-direction: column; gap: 14px;
      margin-bottom: 20px;
    }

    .msg {
      font-size: 0.95rem; line-height: 1.65;
      animation: fadeUp 0.3s ease both;
    }

    .msg.user { color: var(--text); font-weight: 600; }
    .msg.user::before { content: 'You  '; color: var(--accent); font-size: 0.72rem; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; display: block; margin-bottom: 3px; }
    .msg.ai { color: var(--muted); }
    .msg.ai::before { content: 'BreakFree  '; color: var(--muted); font-size: 0.72rem; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; display: block; margin-bottom: 3px; }

    .chat-input-row { display: flex; gap: 12px; align-items: flex-end; }

    .chat-field {
      flex: 1; background: transparent; border: none;
      border-bottom: 2px solid var(--border);
      color: var(--text); font-family: 'Nunito', sans-serif;
      font-size: 0.95rem; padding: 10px 4px;
      outline: none; transition: border-color 0.2s;
      border-radius: 0;
    }

    .chat-field:focus { border-bottom-color: var(--accent); }
    .chat-field::placeholder { color: var(--muted); }

    .btn-send {
      padding: 10px 22px;
      background: none;
      border: 1.5px solid var(--border);
      color: var(--text); border-radius: 999px;
      font-family: 'Nunito', sans-serif;
      font-weight: 700; font-size: 0.85rem;
      cursor: pointer;
      transition: border-color 0.2s, background 0.2s;
      white-space: nowrap;
    }

    .btn-send:hover:not(:disabled) { border-color: var(--accent); background: rgba(107,159,255,0.07); }
    .btn-send:disabled { opacity: 0.35; cursor: not-allowed; }

    .support-note {
      font-size: 0.78rem; color: var(--muted);
      margin-top: 10px;
    }

    /* Reset */
    .reset-line {
      text-align: center;
      padding: 40px 0 20px;
    }

    .btn-reset {
      background: none; border: none;
      color: var(--muted); font-family: 'Nunito', sans-serif;
      font-size: 0.82rem; cursor: pointer;
      text-decoration: underline;
      text-underline-offset: 3px;
      transition: color 0.2s;
    }

    .btn-reset:hover { color: var(--text); }

    /* Error */
    .error-msg {
      background: rgba(255,100,100,0.08);
      border: 1px solid rgba(255,100,100,0.25);
      border-radius: 10px;
      padding: 12px 16px;
      font-size: 0.86rem;
      color: #ff9a9a;
      margin-top: 16px;
      display: none;
    }

    @keyframes fadeUp { from{opacity:0;transform:translateY(16px)} to{opacity:1;transform:translateY(0)} }
    @keyframes ptsPop { 0%{transform:scale(1)} 50%{transform:scale(1.15)} 100%{transform:scale(1)} }
    .pop { animation: ptsPop 0.35s ease; }

    @media (max-width: 560px) {
      .options-grid { grid-template-columns: 1fr; }
      .landing-title { font-size: 2.4rem; }
      .pts-number { font-size: 2.4rem; }
    }
  </style>
</head>
<body>
<div id="app">

  <header>
    <div class="logo">Break<span>Free</span></div>
    <div class="header-right">
      <div class="points-badge" id="pointsBadge">‚≠ê <span id="headerPoints">0</span> pts</div>
      <div class="calls-badge">
        <div class="dot"></div>
        <span id="callsText">AI Ready</span>
      </div>
    </div>
  </header>

  <!-- ‚îÄ‚îÄ LANDING ‚îÄ‚îÄ -->
  <div id="landingScreen">
    <div class="landing-eyebrow">AI Habit Recovery</div>
    <h1 class="landing-title">Know your habit.<br/><em>Break it for good.</em></h1>
    <p class="landing-sub">Answer a few questions and the AI will build you a personal 30-day recovery plan ‚Äî with daily goals and a points system to keep you going.</p>
    <button class="btn-start" onclick="startJourney()">Start Your Journey ‚Üí</button>
    <button class="btn-demo" onclick="loadDemo()">Preview Demo Plan</button>
  </div>

  <!-- ‚îÄ‚îÄ INTERVIEW ‚îÄ‚îÄ -->
  <div id="interviewScreen" style="display:none;">
    <div class="interview-progress">
      <div class="progress-track">
        <div class="progress-track-fill" id="progressFill" style="width:0%"></div>
      </div>
      <div class="progress-label" id="progressLabel">1 of 8</div>
    </div>
    <div class="question-wrap" id="questionWrap"></div>
    <div class="error-msg" id="errorMsg"></div>
  </div>

  <!-- ‚îÄ‚îÄ LOADING ‚îÄ‚îÄ -->
  <div id="loadingScreen" style="display:none;">
    <div class="loader"></div>
    <div class="loading-title">Building your plan...</div>
    <div class="loading-sub">Personalizing your 30-day recovery journey.</div>
  </div>

  <!-- ‚îÄ‚îÄ PLAN ‚îÄ‚îÄ -->
  <div id="planScreen" style="display:none;">

    <div class="dx-section" id="dxSection">
      <div class="dx-eyebrow">Your Diagnosis</div>
      <div class="dx-title" id="dxTitle">‚Äî</div>
      <div class="dx-text" id="dxText">‚Äî</div>
    </div>



    <div class="day-section" id="daySection">
      <div class="day-nav-top">
        <div class="day-nav-info">
          <div class="day-week-label" id="weekLabel">Week 1</div>
          <div class="day-number-label" id="dayLabel">Day 1</div>
        </div>
        <div class="day-nav-buttons">
          <button class="nav-arrow" id="prevBtn" onclick="changeDay(-1)" disabled>‚Üê</button>
          <button class="nav-arrow" id="nextBtn" onclick="changeDay(1)">‚Üí</button>
        </div>
      </div>

      <div class="thin-progress">
        <div class="thin-progress-fill" id="thinFill" style="width:3.3%"></div>
      </div>

      <div class="goals-area" id="goalsArea"></div>

      <div class="today-pts-line">
        <span id="dayProgressText">Day 1 of 30</span>
      </div>
    </div>

    <div class="journal-section" id="journalSection">
      <div class="journal-label">Today's Notes</div>
      <textarea class="journal-field" id="journalField" placeholder="How did today go? What did you do, feel, or notice..."></textarea>
      <div class="journal-saved" id="journalSaved"></div>
    </div>

    <div class="lockin-section" id="lockinSection">
      <div class="lockin-eyebrow">Your Commitment</div>
      <div class="lockin-title">Ready to lock in?</div>
      <div class="commitment-quote" id="commitmentQuote">Loading...</div>
      <div class="lockin-input-row">
        <input class="lockin-field" id="lockinField" placeholder="Type &quot;I'm in&quot;" />
        <button class="btn-lockin" onclick="handleLockin()">Lock In</button>
      </div>
      <div class="locked-msg" id="lockedMsg">‚úì You're locked in. Day 1 starts now.</div>
    </div>

    <div class="support-section" id="supportSection">
      <div class="support-label">Support</div>
      <div class="chat-messages" id="chatMessages"></div>
      <div class="chat-input-row">
        <input class="chat-field" id="chatField" placeholder="Ask anything about your plan..." onkeydown="if(event.key==='Enter') sendChat()"/>
        <button class="btn-send" id="sendBtn" onclick="sendChat()">Send</button>
      </div>
      <div class="support-note" id="supportNote"></div>
    </div>

    <div class="reset-line">
      <button class="btn-reset" onclick="resetApp()">Start over</button>
    </div>

  </div>

</div>
<script>
  const PROXY_URL     = 'https://us-central1-brophy-ai-api.cloudfunctions.net/brophyProxy';
  const STUDENT_EMAIL = 'jselk27@brophybroncos.org';
  const STORAGE_KEY   = 'breakfree_v3';

  // ‚îÄ‚îÄ QUESTIONS ‚îÄ‚îÄ
  const QUESTIONS = [
    {
      id: 'name', type: 'text',
      label: 'Question 1',
      text: "What's your first name?",
      placeholder: 'Your name...',
      required: true
    },
    {
      id: 'habit', type: 'options',
      label: 'Question 2',
      text: "What's your biggest habit right now?",
      options: [
        'Social media', 'Gaming', 'YouTube / streaming',
        'My phone in general', 'Junk food / snacking', 'Vaping / nicotine', 'Something else'
      ]
    },
    {
      id: 'habitOther', type: 'text',
      label: 'Question 2b',
      text: "Tell us a bit more about it.",
      placeholder: 'Describe your habit...',
      required: false,
      onlyIf: (a) => a.habit === 'Something else'
    },
    {
      id: 'frequency', type: 'options',
      label: 'Question 3',
      text: "How often does it happen?",
      options: ['A few times a week', 'Every day', 'Multiple times a day', 'Almost constantly']
    },
    {
      id: 'trigger', type: 'text',
      label: 'Question 4',
      text: "What usually triggers it?",
      placeholder: 'Boredom, stress, after school...',
      required: false
    },
    {
      id: 'impact', type: 'textarea',
      label: 'Question 5',
      text: "How has it affected your life?",
      placeholder: 'Sleep, grades, relationships...',
      required: false
    },
    {
      id: 'attempts', type: 'text',
      label: 'Question 6',
      text: "Have you tried to stop before? What happened?",
      placeholder: 'Deleted the app, lasted a day...',
      required: false
    },
    {
      id: 'seriousness', type: 'serious',
      label: 'Last one',
      text: "How serious are you about breaking this?",
      options: [
        { value: 'high', emoji: 'üî•', title: "I'm fully committed", desc: 'Give me a tough, no-excuses plan' },
        { value: 'low',  emoji: 'üå±', title: 'Taking it step by step', desc: 'Start gentle, build from there' }
      ]
    }
  ];

  // ‚îÄ‚îÄ STATE ‚îÄ‚îÄ
  let answers      = {};
  let currentQ     = 0;
  let visibleQs    = [];
  let planDays     = [];
  let progress     = { currentDay: 0, totalPoints: 0, dayData: {} };
  let planContext  = '';
  let chatHistory  = [];
  let supportUsed  = 0;
  const MAX_SUPPORT = 1;

  // ‚îÄ‚îÄ BOOT ‚îÄ‚îÄ
  function init() {
    const saved = loadSaved();
    if (!saved) return;
    showPlanScreen();
  }

  function loadSaved() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return false;
      const d = JSON.parse(raw);
      if (!d.planDays || d.planDays.length !== 30) return false;
      planDays    = d.planDays;
      progress    = d.progress || { currentDay:0, totalPoints:0, dayData:{} };
      planContext  = d.planContext || '';
      document.getElementById('dxTitle').textContent         = d.diagnosisTitle || '';
      document.getElementById('dxText').textContent          = d.diagnosisText  || '';
      document.getElementById('commitmentQuote').textContent = d.commitmentStatement || '';
      if (d.locked) {
        document.getElementById('lockedMsg').style.display  = 'block';
        document.getElementById('lockinField').disabled     = true;
        document.getElementById('lockinField').value        = "I'm in ‚úì";
        document.querySelector('.btn-lockin').disabled      = true;
        document.getElementById('supportSection').style.display = 'block';
        updateSupportNote();
      }
      return true;
    } catch(e) { return false; }
  }

  function saveProgress(extra = {}) {
    try {
      const base = {
        planDays, progress, planContext,
        diagnosisTitle:      document.getElementById('dxTitle').textContent,
        diagnosisText:       document.getElementById('dxText').textContent,
        commitmentStatement: document.getElementById('commitmentQuote').textContent,
        locked: document.getElementById('lockedMsg').style.display === 'block',
      };
      localStorage.setItem(STORAGE_KEY, JSON.stringify({ ...base, ...extra }));
    } catch(e) {}
  }

  // ‚îÄ‚îÄ LANDING ‚îÄ‚îÄ
  function startJourney() {
    document.getElementById('landingScreen').style.display = 'none';
    document.getElementById('interviewScreen').style.display = 'block';
    buildVisibleQs();
    renderQuestion(0);
  }

  function buildVisibleQs() {
    visibleQs = QUESTIONS.filter(q => !q.onlyIf || q.onlyIf(answers));
  }

  // ‚îÄ‚îÄ INTERVIEW ‚îÄ‚îÄ
  function renderQuestion(index) {
    currentQ = index;
    buildVisibleQs();
    const q = visibleQs[index];
    if (!q) return;

    const total = visibleQs.length;
    document.getElementById('progressFill').style.width = `${((index) / total) * 100}%`;
    document.getElementById('progressLabel').textContent = `${index + 1} of ${total}`;

    const wrap = document.getElementById('questionWrap');
    wrap.style.opacity = '0';
    wrap.style.transform = 'translateY(12px)';

    setTimeout(() => {
      let html = `<div class="question-label">${q.label}</div>
                  <div class="question-text">${q.text}</div>`;

      if (q.type === 'text') {
        const val = answers[q.id] || '';
        html += `<div class="text-answer-wrap">
          <input class="text-answer" id="answerInput" value="${val}" placeholder="${q.placeholder || ''}" onkeydown="if(event.key==='Enter') nextQuestion()" oninput="onInputChange()" autofocus/>
        </div>`;
      } else if (q.type === 'textarea') {
        const val = answers[q.id] || '';
        html += `<div class="text-answer-wrap">
          <textarea class="textarea-answer" id="answerInput" placeholder="${q.placeholder || ''}" oninput="onInputChange()">${val}</textarea>
        </div>`;
      } else if (q.type === 'options') {
        html += `<div class="options-grid" id="optionsGrid">`;
        q.options.forEach(opt => {
          const sel = answers[q.id] === opt ? 'selected' : '';
          html += `<button class="option-btn ${sel}" onclick="selectOption(event,'${q.id}', '${opt.replace(/'/g,"&#39;")}')">${opt}</button>`;
        });
        html += `</div>`;
      } else if (q.type === 'serious') {
        html += `<div class="options-grid" id="optionsGrid">`;
        q.options.forEach(opt => {
          const sel = answers[q.id] === opt.value ? 'selected' : '';
          html += `<button class="option-btn serious-btn ${sel}" onclick="selectOption(event,'${q.id}', '${opt.value}')">
            <span class="s-emoji">${opt.emoji}</span>
            <span class="s-title">${opt.title}</span>
            <span class="s-desc">${opt.desc}</span>
          </button>`;
        });
        html += `</div>`;
      }

      const isLast = index === visibleQs.length - 1;
      const canProceed = answers[q.id] || !q.required;
      const nextLabel  = isLast ? 'Build My Plan ‚Üí' : 'Continue ‚Üí';

      html += `<div style="display:flex;align-items:center;margin-top:8px;">`;
      if (index > 0) html += `<button class="btn-back" onclick="prevQuestion()">‚Üê Back</button>`;
      html += `<button class="btn-next" id="nextBtn" onclick="nextQuestion()" ${canProceed || q.type !== 'text' ? '' : 'disabled'}>${nextLabel}</button>`;
      html += `</div>`;

      wrap.innerHTML = html;

      requestAnimationFrame(() => {
        wrap.style.transition = 'opacity 0.35s ease, transform 0.35s ease';
        wrap.style.opacity    = '1';
        wrap.style.transform  = 'translateY(0)';
      });

      const inp = document.getElementById('answerInput');
      if (inp && q.type === 'text') setTimeout(() => inp.focus(), 50);

    }, 80);
  }

  function onInputChange() {
    const q   = visibleQs[currentQ];
    const inp = document.getElementById('answerInput');
    const btn = document.getElementById('nextBtn');
    if (!inp || !btn) return;
    if (q.required) btn.disabled = !inp.value.trim();
  }

  function selectOption(e, id, value) {
    answers[id] = value;
    buildVisibleQs();
    document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
    e.currentTarget.classList.add('selected');
    setTimeout(() => nextQuestion(), 280);
  }

  function nextQuestion() {
    const q   = visibleQs[currentQ];
    const inp = document.getElementById('answerInput');
    if (inp) answers[q.id] = inp.value.trim();

    if (q.required && !answers[q.id]) {
      document.getElementById('errorMsg').textContent = 'Please answer this question to continue.';
      document.getElementById('errorMsg').style.display = 'block';
      return;
    }
    document.getElementById('errorMsg').style.display = 'none';

    buildVisibleQs();
    const next = currentQ + 1;

    if (next >= visibleQs.length) {
      submitAnswers();
    } else {
      renderQuestion(next);
    }
  }

  function prevQuestion() {
    if (currentQ > 0) renderQuestion(currentQ - 1);
  }

  // ‚îÄ‚îÄ SUBMIT ‚îÄ‚îÄ
  async function submitAnswers() {
    document.getElementById('interviewScreen').style.display = 'none';
    document.getElementById('loadingScreen').style.display   = 'block';

    const name       = answers.name || 'Friend';
    const habit      = answers.habit === 'Something else' ? (answers.habitOther || 'unspecified habit') : (answers.habit || 'phone');
    const frequency  = answers.frequency || 'daily';
    const trigger    = answers.trigger   || 'not specified';
    const impact     = answers.impact    || 'not specified';
    const attempts   = answers.attempts  || 'none';
    const seriousness = answers.seriousness || 'low';

    const tone = seriousness === 'high'
      ? 'The user is fully committed. Make goals challenging and direct.'
      : 'The user wants to ease in gently. Make goals encouraging and low-pressure.';

    const system = `You are BreakFree, an empathetic AI habit coach for teenagers. ${tone}
CRITICAL: Respond ONLY with a raw JSON object. No markdown, no backticks, no text before or after. Start with { end with }.`;

    const prompt = `Diagnose this teenager's habit and generate a 30-day recovery plan.

USER:
- Name: ${name}, Habit: ${habit}, Frequency: ${frequency}
- Triggers: ${trigger}, Impact: ${impact}
- Previous attempts: ${attempts}
- Commitment: ${seriousness === 'high' ? 'Fully committed, wants tough plan' : 'Gentle start, wants encouraging plan'}

Return ONLY this raw JSON:
{
  "diagnosisTitle": "punchy name for their addiction pattern (3-5 words)",
  "diagnosisText": "2 sentences on what is really going on. Direct and real.",
  "commitmentStatement": "One powerful sentence written directly to ${name} about breaking this habit.",
  "week1Title": "Week 1 theme",
  "week1Goals": ["goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal"],
  "week2Title": "Week 2 theme",
  "week2Goals": ["goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal"],
  "week3Title": "Week 3 theme",
  "week3Goals": ["goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal"],
  "week4Title": "Week 4 theme",
  "week4Goals": ["goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal","goal"]
}
Each array = exactly 21 strings (7 days x 3 goals). Each goal: single short string, NO newlines, NO line breaks, under 12 words, specific and actionable. Goals get harder each week. Personal to ${name}'s habit.`;

    try {
      const raw    = await callProxy([{ role:'user', content: prompt }], system);
      const parsed = parseJSON(raw);

      planDays    = buildPlanDays(parsed);
      progress    = { currentDay:0, totalPoints:0, dayData:{} };
      planContext  = `User: ${name}, Habit: ${habit}. Plan: ${parsed.week1Title}, ${parsed.week2Title}, ${parsed.week3Title}, ${parsed.week4Title}.`;

      document.getElementById('dxTitle').textContent         = parsed.diagnosisTitle || 'Your Habit Pattern';
      document.getElementById('dxText').textContent          = parsed.diagnosisText  || '';
      document.getElementById('commitmentQuote').textContent = parsed.commitmentStatement || '';

      document.getElementById('loadingScreen').style.display = 'none';
      showPlanScreen();
      saveProgress();

    } catch(err) {
      document.getElementById('loadingScreen').style.display   = 'none';
      document.getElementById('interviewScreen').style.display = 'block';
      document.getElementById('errorMsg').textContent = err.message || 'Something went wrong. Please try again.';
      document.getElementById('errorMsg').style.display = 'block';
    }
  }

  // ‚îÄ‚îÄ SHOW PLAN ‚îÄ‚îÄ
  function showPlanScreen() {
    document.getElementById('landingScreen').style.display    = 'none';
    document.getElementById('interviewScreen').style.display  = 'none';
    document.getElementById('loadingScreen').style.display    = 'none';
    document.getElementById('planScreen').style.display       = 'block';
    document.getElementById('pointsBadge').style.display      = 'flex';
    renderDay(progress.currentDay);
    updatePointsUI();
  }

  // ‚îÄ‚îÄ PARSE JSON ‚îÄ‚îÄ
  function parseJSON(raw) {
    let c = raw.replace(/```json|```/gi,'').trim();
    const m = c.match(/\{[\s\S]*\}/);
    if (m) c = m[0];
    // Strip newlines inside string values
    c = c.replace(/"([^"]*)"/g, (_,inner) => '"' + inner.replace(/[\r\n]+/g,' ').replace(/\s+/g,' ').trim() + '"');
    try { return JSON.parse(c); } catch(e) {
      let r = c.trimEnd();
      if (!r.endsWith('}')) {
        if ((r.match(/"/g)||[]).length % 2 !== 0) r += '"';
        r += '\n}';
      }
      return JSON.parse(r);
    }
  }

  function buildPlanDays(parsed) {
    const days = [];
    [
      { num:1, title:parsed.week1Title||'Week 1', goals:parsed.week1Goals||[] },
      { num:2, title:parsed.week2Title||'Week 2', goals:parsed.week2Goals||[] },
      { num:3, title:parsed.week3Title||'Week 3', goals:parsed.week3Goals||[] },
      { num:4, title:parsed.week4Title||'Week 4', goals:parsed.week4Goals||[] },
    ].forEach(w => {
      for (let d=0; d<7; d++) {
        days.push({
          weekNum: w.num, weekTitle: w.title,
          goals: [
            w.goals[d*3]   || 'Complete a healthy activity today.',
            w.goals[d*3+1] || 'Reflect on your progress so far.',
            w.goals[d*3+2] || 'Do something kind for yourself.',
          ]
        });
      }
    });
    return days;
  }

  // ‚îÄ‚îÄ RENDER DAY ‚îÄ‚îÄ
  function renderDay(index) {
    if (!planDays[index]) return;
    const day    = planDays[index];
    const dayNum = index + 1;

    document.getElementById('weekLabel').textContent      = `${day.weekTitle} ¬∑ Week ${day.weekNum}`;
    document.getElementById('dayLabel').textContent       = `Day ${dayNum}`;
    document.getElementById('dayProgressText').textContent= `Day ${dayNum} of 30`;
    document.getElementById('thinFill').style.width       = `${(dayNum/30)*100}%`;
    document.getElementById('prevBtn').disabled = index === 0;
    document.getElementById('nextBtn').disabled = index === 29;

    // Load journal entry for this day
    const jField = document.getElementById('journalField');
    const jSaved = document.getElementById('journalSaved');
    const saved2 = progress.dayData[index] || {};
    jField.value = saved2.journal || '';
    jSaved.textContent = '';
    jField.oninput = () => {
      clearTimeout(jField._timer);
      jField._timer = setTimeout(() => {
        if (!progress.dayData[index]) progress.dayData[index] = { completed:[false,false,false], points:0 };
        progress.dayData[index].journal = jField.value;
        saveProgress();
        jSaved.textContent = 'Saved ‚úì';
        setTimeout(() => { jSaved.textContent = ''; }, 2000);
      }, 800);
    };

    const saved = progress.dayData[index] || { completed:[false,false,false], points:0 };
    const area  = document.getElementById('goalsArea');
    area.innerHTML = '';

    day.goals.forEach((goal, gi) => {
      const done = saved.completed[gi] || false;
      const row  = document.createElement('div');
      row.className = `goal-row${done?' done':''}`;
      row.innerHTML = `
        <div class="goal-check-circle">${done ? '‚úì' : ''}</div>
        <div class="goal-body">
          <div class="goal-body-text">${goal}</div>
          <div class="goal-pts-tag">+5 pts earned</div>
        </div>`;
      row.addEventListener('click', () => toggleGoal(index, gi));
      area.appendChild(row);
    });


  }

  function toggleGoal(dayIndex, goalIndex) {
    if (!progress.dayData[dayIndex])
      progress.dayData[dayIndex] = { completed:[false,false,false], points:0 };
    const d   = progress.dayData[dayIndex];
    const was = d.completed[goalIndex];
    d.completed[goalIndex] = !was;
    progress.totalPoints  += was ? -5 : 5;
    if (progress.totalPoints < 0) progress.totalPoints = 0;
    d.points = d.completed.filter(Boolean).length * 5;
    updatePointsUI();
    renderDay(dayIndex);
    saveProgress();
  }

  function updatePointsUI() {
    const pts = progress.totalPoints;
    document.getElementById('headerPoints').textContent = pts;
    const badge = document.getElementById('pointsBadge');
    badge.classList.remove('pop');
    void badge.offsetWidth;
    badge.classList.add('pop');
  }

  function changeDay(dir) {
    const next = progress.currentDay + dir;
    if (next < 0 || next > 29) return;
    progress.currentDay = next;
    renderDay(next);
    saveProgress();
    document.getElementById('daySection').scrollIntoView({ behavior:'smooth', block:'start' });
  }

  // ‚îÄ‚îÄ LOCK IN ‚îÄ‚îÄ
  function handleLockin() {
    const val = document.getElementById('lockinField').value.trim().toLowerCase().replace(/['']/g,"'");
    if (val === "i'm in" || val === "im in") {
      document.getElementById('lockedMsg').style.display  = 'block';
      document.getElementById('lockinField').disabled     = true;
      document.querySelector('.btn-lockin').disabled      = true;
      document.getElementById('lockinField').value        = "I'm in ‚úì";
      setTimeout(() => {
        document.getElementById('supportSection').style.display = 'block';
        updateSupportNote();
        document.getElementById('supportSection').scrollIntoView({ behavior:'smooth', block:'start' });
      }, 700);
      saveProgress();
    } else {
      document.getElementById('lockinField').style.borderBottomColor = 'var(--accent)';
      document.getElementById('lockinField').placeholder = "Type exactly: I'm in";
      setTimeout(() => { document.getElementById('lockinField').style.borderBottomColor = ''; }, 1400);
    }
  }

  // ‚îÄ‚îÄ SUPPORT ‚îÄ‚îÄ
  function updateSupportNote() {
    const r = MAX_SUPPORT - supportUsed;
    document.getElementById('supportNote').textContent =
      r > 0 ? `${r} support message remaining.` : "You've used your support message. Trust your plan ‚Äî you've got this.";
    if (r <= 0) {
      document.getElementById('chatField').disabled = true;
      document.getElementById('sendBtn').disabled   = true;
    }
  }

  async function sendChat() {
    const field = document.getElementById('chatField');
    const msg   = field.value.trim();
    if (!msg || supportUsed >= MAX_SUPPORT) return;
    field.value = '';
    addMsg('user', msg);
    document.getElementById('sendBtn').disabled = true;
    chatHistory.push({ role:'user', content:msg });
    const sys = `You are BreakFree, a supportive AI habit coach. Context: ${planContext}. Keep responses 3-5 sentences, warm, direct, actionable.`;
    try {
      const reply = await callProxy(chatHistory, sys);
      chatHistory.push({ role:'assistant', content:reply });
      addMsg('ai', reply);
      supportUsed++;
    } catch(e) { addMsg('ai','Something went wrong. Please try again.'); }
    finally {
      document.getElementById('sendBtn').disabled = false;
      updateSupportNote();
    }
  }

  function addMsg(role, text) {
    const el = document.createElement('div');
    el.className = `msg ${role}`;
    el.textContent = text;
    document.getElementById('chatMessages').appendChild(el);
    el.scrollIntoView({ behavior:'smooth', block:'nearest' });
  }

  // ‚îÄ‚îÄ PROXY ‚îÄ‚îÄ
  async function callProxy(messages, system='') {
    const body = { messages, max_tokens:1500 };
    if (system) body.system = system;
    const res = await fetch(PROXY_URL, {
      method:'POST',
      headers:{ 'Content-Type':'application/json', 'x-student-email': STUDENT_EMAIL },
      body: JSON.stringify(body)
    });
    if (!res.ok) { const e = await res.json().catch(()=>({})); throw new Error(e.error||`Error ${res.status}`); }
    const data = await res.json();
    if (data._brophy) {
      const r = data._brophy.callsRemaining;
      document.getElementById('callsText').textContent = `${r} calls left`;
      const dot = document.querySelector('.calls-badge .dot');
      if (r<=5) dot.style.background='#ffaa4d';
      if (r<=2) dot.style.background='#ff6b6b';
    }
    return data.content[0].text;
  }

  // ‚îÄ‚îÄ RESET ‚îÄ‚îÄ
  function resetApp() {
    if (!confirm('This will clear your progress and start over. Are you sure?')) return;
    localStorage.removeItem(STORAGE_KEY);
    answers={}; planDays=[]; progress={currentDay:0,totalPoints:0,dayData:{}}; chatHistory=[]; supportUsed=0; planContext='';
    document.getElementById('planScreen').style.display      = 'none';
    document.getElementById('interviewScreen').style.display = 'none';
    document.getElementById('landingScreen').style.display   = 'block';
    document.getElementById('pointsBadge').style.display     = 'none';
    document.getElementById('headerPoints').textContent      = '0';
    document.getElementById('lockedMsg').style.display       = 'none';
    document.getElementById('lockinField').disabled          = false;
    document.getElementById('lockinField').value             = '';
    document.querySelector('.btn-lockin').disabled           = false;
    document.getElementById('chatMessages').innerHTML        = '';
    document.getElementById('supportSection').style.display  = 'none';
    window.scrollTo({ top:0, behavior:'smooth' });
  }

  // ‚îÄ‚îÄ DEMO MODE ‚îÄ‚îÄ
  function loadDemo() {
    const demoGoals = (week) => {
      const banks = {
        1: ['Notice when you reach for your phone without thinking','Write down what you were feeling before you grabbed it','Set a 10pm phone curfew tonight'],
        2: ['Delete one app you mindlessly open','Move social apps to a buried folder','Do one thing from your boredom list instead of scrolling'],
        3: ['Spend 20 mins on something you actually enjoy','Text a friend instead of scrolling their story','No phone for the first 30 mins after waking up'],
        4: ['Phone charges outside your bedroom tonight','Check messages at set times only ‚Äî not constantly','Write one thing you are proud of this week'],
      };
      const b = banks[week];
      const arr = [];
      for (let i=0;i<7;i++) arr.push(...b);
      return arr.slice(0,21);
    };

    const parsed = {
      diagnosisTitle: 'Dopamine Scroll Loop',
      diagnosisText: "Your brain has learned that boredom and stress mean it's time to scroll ‚Äî it's not about the content, it's about escaping the feeling. The habit isn't really about your phone, it's about not having built ways to sit with uncomfortable emotions yet.",
      commitmentStatement: "You already know this habit is costing you ‚Äî now it's time to build something better in its place, one day at a time.",
      week1Title: 'Awareness', week1Goals: demoGoals(1),
      week2Title: 'Friction',  week2Goals: demoGoals(2),
      week3Title: 'Replacement', week3Goals: demoGoals(3),
      week4Title: 'Lock-In',  week4Goals: demoGoals(4),
    };

    planDays   = buildPlanDays(parsed);
    progress   = { currentDay: 0, totalPoints: 0, dayData: {} };
    planContext = 'Demo user. Habit: phone/social media.';

    document.getElementById('dxTitle').textContent         = parsed.diagnosisTitle;
    document.getElementById('dxText').textContent          = parsed.diagnosisText;
    document.getElementById('commitmentQuote').textContent = parsed.commitmentStatement;

    showPlanScreen();
    document.getElementById('headerPoints').textContent = '0';
  }

  init();
</script>
</body>
</html>
